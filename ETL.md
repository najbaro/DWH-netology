Процедура ETL

В ETL.kjb запускается последовательно две трансформации:

1. transformation_etl_dimention_tables.ktr запускает загрузку данных из схемы bookings одновременно в пять таблиц измерений:

    1. dim_aircrafts - из таблицы aircrafts_data 3 атрибута: aircraft_code, model (английская версия) и range

    2. dim_airports - из таблицы airports_data 5 атрибутов: airport_code, airport_name (английская версия), city (английская версия), coordinates и timezone

    3. dim_calendar - из таблицы flights достаются два поля - минималоьное значение по планируемой отправке и максимальное по прибытию, после чего генерируется календарь между этих двух дат

    4. dim_passenger - из таблицы tickets достаются passenger_id, passenger_name и contact_data, в конечную выгрузку попадают уникальные passenger_id, остальные атрибуты, имя и контактная информация, берутся по принципу "первый встретившийся".

    5. dim_tariff - из таблицы seats уникальные значения атрибута fare_condition
2. transformation_etl_fact_table.ktr запускает загрузку данных в таблицу фактов fact_flights согласно следующих условий: Fact_Flights - содержит совершенные перелеты, а также информацию о Пассажирах, Дате и времени вылета (факт), Дате и времени прилета (факт), Задержке вылета (разница между фактической и запланированной датой в секундах), Задержке прилета (разница между фактической и запланированной датой в секундах), Самолете, Аэропорте вылета, Аэропорте прилета, Классе обслуживания, Стоимости
